ec.load("ajax");ec.pkg("ec.index");ec.index.clickHref=function(url){ec.openWindow(url)};ec.index.sales=function(obj){};ec.index.salesStatus=[];ec.index.salesCallBack=function($saleList,json){var $this,lst=[],_now=new Date;_now.setTime(ec.util.parseDate(ec.index.now));var _switchStatus=function(status,obj){var $this=$(obj),type=$this.attr("data-skutype"),$btn=$(".channel-button",$this);switch(parseInt(status,10)){case 0:$btn.html("马上开始").attr("title","马上开始");if(type==3||type==4){$btn.attr("class","channel-button-begin")}break;case 1:if(type==3){$btn.html("去看看").attr("title","去看看")}else{$btn.html("立即抢购").attr("title","立即抢购")}$btn.attr("class","channel-button");break;case 2:$btn.html("活动结束").attr("title","活动结束");if(type==2||type==3){$btn.attr("class","channel-button-end")}break}};for(var i=0;i<json.infoList.length;i+=1){$this=$saleList[i];lst=json.infoList[i];$(".channel-button",$this).css("visibility","");if(!lst||!lst.id)continue;if(lst.status==1){if(lst.startTime&&lst.startTime>=_now)lst.status=0;if(lst.endTime&&lst.endTime<=_now)lst.status=2}_switchStatus(lst.status,$this);if(lst.startTime||lst.endTime||lst.limitAmount>0){$(".p-countdown",$this).show()}if(lst.limitAmount>0)$(".p-quantity",$this).html("限<b>"+lst.limitAmount+"</b>台").show();var price=parseFloat($($this).attr("data-price"),10);if(lst.price>0){if(parseInt(lst.price)==lst.price){$(".p-sale-price span, .p-price span",$this).html(lst.price);if(parseInt(price)==price){$(".economize",$this).html(price-lst.price)}else{$(".economize",$this).html((price-lst.price).toFixed(2))}}else{$(".p-sale-price span, .p-price span",$this).html(lst.price.toFixed(2));if(price-lst.price==0){$(".economize",$this).html("0")}else{$(".economize",$this).html((price-lst.price).toFixed(2))}}}$(".sale-quantity",$this).html(lst.saleAmount);if(lst.status!=2&&(lst.startTime||lst.endTime)){var isSlider=$($this).attr("data-block")=="slider"?true:false,t=[];if(lst.startTime)t.push(ec.util.parseDate(lst.startTime).format("yyyy-MM-dd HH:mm:ss"));if(lst.endTime)t.push(ec.util.parseDate(lst.endTime).format("yyyy-MM-dd HH:mm:ss"));ec.index.salesStatus[i]=lst.status;ec.ui.countdown($(".p-time",$this),{html:"<b>"+(isSlider?"":"剩余")+"</b><ins><i>{#hours}</i><s></s></ins><em>时</em><ins><i>{#minutes}</i><s></s></ins><em>分</em><ins><i>{#seconds}</i><s></s></ins><em>秒</em>",now:_now,times:t,index:i,callback:function(json){ec.index.salesStatus[json.index]++;_switchStatus(ec.index.salesStatus[json.index],$saleList[json.index])}})}}};ec.ready(function(){if(ec.account.isLogin()){$("#cust_login_info").hide()}var bigAd=ec.index.bigAd,smallAd=ec.index.smallAd,bigadShowTime=ec.index.bigadShowTime,$maxAd,$minAd,_slideToggle=function(){var minAdHeight=$minAd.innerHeight();var maxAdHeight=$maxAd.innerHeight();var top=$("#search-bar-form").offset().top-maxAdHeight+minAdHeight;var height=$("#search-bar-form").innerHeight();$(".autocomplete-w1").parent().hide();$maxAd.slideUp(1e3,function(){if(smallAd)$minAd.show();$(".autocomplete-w1").parent().css({top:top+height+"px"});$(".autocomplete-w1").parent().show();ec.index.SCROLL_GET=ec.index.getscrollLayout()});if(_s)clearTimeout(_s)},_s;$("#top-banner-block").html(gid("top-banner").value);$maxAd=$("#top-banner-max");$minAd=$("#top-banner-min");$("#top-banner-min-close").click(function(){$("#top-banner-block").hide();ec.index.SCROLL_GET=ec.index.getscrollLayout()});if(bigAd){$maxAd.show();ec.index.SCROLL_GET=ec.index.getscrollLayout();$("#top-banner-max-toggle").click(_slideToggle);_s=setTimeout(_slideToggle,bigadShowTime)}if(smallAd&&!bigAd){$minAd.show();ec.index.SCROLL_GET=ec.index.getscrollLayout()}if(!smallAd&&!bigAd){ec.index.SCROLL_GET=ec.index.getscrollLayout()}$("body .layout .channel-pro-item").hover(function(){$(this).addClass("pro-info-hover")},function(){$(this).removeClass("pro-info-hover")});ec.index.floatLayout()});ec.index.SCROLL_GET={};ec.index.getscrollLayout=function(){var $scrollObj=$(".home-channel-container .layout"),$layout=$(".event-float-layout"),scrollListHeight=[],scrollList=[];if($scrollObj.length==0||$layout.length==0)return false;$scrollObj.each(function(index,item){scrollList.push($(this).offset().top);scrollListHeight.push($(this).outerHeight())});return{scrollListHeight:scrollListHeight,scrollList:scrollList,top:$layout.offset().top}};ec.index.floatLayout=function(){var $layout=$(".event-float-layout");if($layout.length==0||ec.index.SCROLL_GET===false)return false;$("body").css({"min-width":"1200px","overflow-x":"hidden"});var $float=$(".event-float"),$hungBarTop=$(".hungBar-top"),$scrollObj=$(".home-channel-container .layout"),$container=$(".home-channel-container"),$title=$(".home-channel-container .layout .channel-title"),titleList="";$layout.find("ul").children().remove();function htmlToText(txt){return $("<span/>").text(txt).html()}$scrollObj.each(function(index,item){titleList+='<li><a data-id="'+index+'" href="javascript:;"  onclick = "pushMsg(\''+htmlToText($title.eq(index).text())+"');\">"+htmlToText($title.eq(index).text())+"</a></li>"});$layout.find("ul").append(titleList);$layout.bind("click",function(e){var target=$(e.target);if(target[0].nodeName.toLowerCase()==="a"){var num=parseInt(target.attr("data-id"));target.parent().addClass("hover").siblings().removeClass("hover");$("html,body").animate({scrollTop:ec.index.SCROLL_GET.scrollList[num]+"px"},400)}});var height=$layout.outerHeight(),offset=$float.offset(),left=offset.left,Wheight=$(window).height(),fixTop=Wheight/2-height/2,len=$scrollObj.length,i=true;$layout.css({height:len*47+"px",top:fixTop+"px"});if(document.body.clientWidth<=1400){$layout.hide();i=false}if($.browser.msie&&parseInt($.browser.version)<=9)$layout.hide();if($.browser.msie&&parseInt($.browser.version)<=7){i=false}else{$(window).scroll(function(){if(!i){return}var scrollTop=$(window).scrollTop();if(scrollTop>=Wheight){$hungBarTop.fadeIn(80)}else{$hungBarTop.fadeOut(80)}if(scrollTop>=ec.index.SCROLL_GET.scrollList[0]-fixTop){$layout.css({top:fixTop+"px"}).addClass("tool-Fixed");if($.browser.msie&&parseInt($.browser.version)>=8&&parseInt($.browser.version)<=9)$layout.show();$.each(ec.index.SCROLL_GET.scrollList,function(index,item){if(scrollTop>=item-ec.index.SCROLL_GET.scrollListHeight[index]/2){$layout.find("li").eq(index).addClass("hover").siblings().removeClass("hover")}});if(scrollTop>=ec.index.SCROLL_GET.scrollList[len-1]+ec.index.SCROLL_GET.scrollListHeight[len-1]/2-len*47){$layout.removeClass("tool-Fixed");if($.browser.msie&&parseInt($.browser.version)>=8&&parseInt($.browser.version)<=9)$layout.hide()}}else{$layout.removeClass("tool-Fixed");if($.browser.msie&&parseInt($.browser.version)>=8&&parseInt($.browser.version)<=9)$layout.hide()}},200)}$(window).resize(function(){if(document.body.clientWidth>1400){$layout.show();i=true;return}$layout.hide();i=false;$("body").css({"min-width":"1200px","overflow-x":"auto"})},200);if($(window).scrollTop()>0){$(window).trigger("scroll")}};$(document).ready(function(){var $goodsRolling=$(".goods-rolling"),goodIdList=[];$goodsRolling.each(function(index,item){goodIdList.push($(this).attr("id"))});$.each(goodIdList,function(index,item){var totalLen=$("#"+item).find(".swiper-slide").length;if(totalLen<=5.5){$("#"+item).find(".swiper-button-prev").addClass("disabled");$("#"+item).find(".swiper-button-next").addClass("disabled")}else{$("#"+item).find(".swiper-button-next").removeClass("disabled")}var mySwiper=new Swiper("#"+item,{slidesPerView:5.59,slidesPerGroup:5.5});$("#"+item).find(".btn-prev").click(function(){mySwiper.swipePrev()});$("#"+item).find(".btn-next").click(function(){mySwiper.swipeNext()})});new Slider({objid:"#notice",listname:".p-notice-list",shownum:1,type:2,autoplay:true}).init();var $bottomImage=$(".bottomImage");if($bottomImage.attr("src")){$bottomImage.show().bind("click",function(){var link=$("#adsArearLink").val();if(link!=null&&link.trim()!=""){var win=ec.openWindow(link);win.opener=null}})}var $itmes=$(".grid-list .grid-items,.grid-promo-list .grid-items");$itmes.hover(function(){$(this).addClass("current")},function(){$(this).removeClass("current")});var $hungBarTop=$(".hungBar-top");$hungBarTop.bind("click",function(){$("html,body").animate({scrollTop:"0px"},400)})});